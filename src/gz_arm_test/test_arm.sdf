<?xml version="1.0" ?>
<sdf version="1.7">
  <world name="simple_arm_test_world">

    <plugin
        filename="gz-sim-physics-system"
        name="gz::sim::systems::Physics"></plugin>
    <plugin
        filename="gz-sim-user-commands-system"
        name="gz::sim::systems::UserCommands"></plugin>
    <plugin
        filename="gz-sim-scene-broadcaster-system"
        name="gz::sim::systems::SceneBroadcaster"></plugin>
    
    <light type="directional" name="sun">
      <cast_shadows>true</cast_shadows>
      <pose>0 0 10 0 0 0</pose>
      <diffuse>0.8 0.8 0.8 1</diffuse>
      <specular>0.2 0.2 0.2 1</specular>
      <direction>-0.5 0.1 -0.9</direction>
    </light>

    <model name="ground_plane">
      <static>true</static>
      <link name="link">
        <collision name="collision"><geometry><plane><normal>0 0 1</normal></plane></geometry></collision>
        <visual name="visual"><geometry><plane><normal>0 0 1</normal><size>10 10</size></plane></geometry>
          <material><ambient>0.8 0.8 0.8 1</ambient><diffuse>0.8 0.8 0.8 1</diffuse><specular>0.8 0.8 0.8 1</specular></material>
        </visual>
      </link>
    </model>

    <model name='simple_arm_test' canonical_link='base_link'>
      <pose>0 0 0.1 0 0 0</pose>
      
      <link name='base_link'>
        <inertial>
          <mass>10.0</mass>
          <inertia><ixx>0.1</ixx><iyy>0.1</iyy><izz>0.1</izz></inertia>
        </inertial>
        <pose>0 0 0 0 0 0</pose>
        <visual name='visual'><geometry><box><size>0.1 0.1 0.2</size></box></geometry><material><ambient>0.5 0.5 0.5 1</ambient><diffuse>0.5 0.5 0.5 1</diffuse></material></visual>
        <collision name='collision'><geometry><box><size>0.1 0.1 0.2</size></box></geometry></collision>
      </link>
      <link name='arm_link_1'>
        <pose relative_to="arm_joint_1">0 0 0.25 0 0 0</pose>
        <inertial>
          <mass>1.0</mass>
          <inertia><ixx>0.01</ixx><iyy>0.01</iyy><izz>0.01</izz></inertia>
        </inertial>
        <visual name='visual'><geometry><box><size>0.08 0.08 0.5</size></box></geometry><material><ambient>0.1 0.1 0.8 1</ambient><diffuse>0.1 0.1 0.8 1</diffuse></material></visual>
        <collision name='collision'><geometry><box><size>0.08 0.08 0.5</size></box></geometry></collision>
      </link>
      <joint name='arm_joint_1' type='revolute'>
        <pose relative_to='base_link'>0 0 0.1 0 0 0</pose>
        <parent>base_link</parent>
        <child>arm_link_1</child>
        <axis>
          <xyz>0 0 1</xyz>
          <limit><lower>-1.57</lower><upper>1.57</upper></limit>
          <dynamics><damping>0.1</damping></dynamics>
        </axis>
      </joint>
      
      <plugin
        filename="gz-sim-joint-controller-system"
        name="gz::sim::systems::JointController">
        <joint_name>arm_joint_1</joint_name>
      </plugin>

      <plugin filename="gz-sim-triggered-publisher-system" name="gz::sim::systems::TriggeredPublisher">
        <input type="gz.msgs.Int32" topic="/keyboard/keypress"><match field="data">81</match></input>
        <output type="gz.msgs.Double" topic="/model/simple_arm_test/joint/arm_joint_1/cmd_vel">data: 0.5</output>
      </plugin>

      <plugin filename="gz-sim-triggered-publisher-system" name="gz::sim::systems::TriggeredPublisher">
        <input type="gz.msgs.Int32" topic="/keyboard/keypress"><match field="data">65</match></input>
        <output type="gz.msgs.Double" topic="/model/simple_arm_test/joint/arm_joint_1/cmd_vel">data: -0.5</output>
      </plugin>
    </model>
  </world>
</sdf>